<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>smeagollib.routes.wiki documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Smeagollib</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>smeagollib</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>smeagollib</span></div></div></li><li class="depth-2 branch"><a href="smeagollib.authenticate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authenticate</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.configuration.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>configuration</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.diff2html.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>diff2html</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extensions</span></div></div></li><li class="depth-3 branch"><a href="smeagollib.extensions.geocsv.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>geocsv</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.extensions.mermaid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mermaid</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.extensions.photoswipe.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>photoswipe</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.extensions.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.extensions.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-3"><a href="smeagollib.extensions.vega.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vega</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.finder.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>finder</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.formatting.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formatting</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.history.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>history</span></div></a></li><li class="depth-2"><a href="smeagollib.include.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>include</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.include.indent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>indent</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.include.parse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parse</span></div></a></li><li class="depth-3 branch"><a href="smeagollib.include.resolve.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resolve</span></div></a></li><li class="depth-3"><a href="smeagollib.include.resolve-local-file.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resolve-local-file</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.layout.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.local-links.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>local-links</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="smeagollib.routes.admin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>admin</span></div></a></li><li class="depth-3 current"><a href="smeagollib.routes.wiki.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wiki</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.sanity.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>sanity</span></div></a></li><li class="depth-2 branch"><a href="smeagollib.uploads.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uploads</span></div></a></li><li class="depth-2"><a href="smeagollib.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-auth-page"><div class="inner"><span>auth-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-collect-preferred"><div class="inner"><span>collect-preferred</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-diff-page"><div class="inner"><span>diff-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-edit-css-page"><div class="inner"><span>edit-css-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-edit-page"><div class="inner"><span>edit-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-format-instant"><div class="inner"><span>format-instant</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-history-page"><div class="inner"><span>history-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-image-extns"><div class="inner"><span>image-extns</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-list-uploads-page"><div class="inner"><span>list-uploads-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-md-include-system"><div class="inner"><span>md-include-system</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-passwd-page"><div class="inner"><span>passwd-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-preferred-source"><div class="inner"><span>preferred-source</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-process-source"><div class="inner"><span>process-source</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-upload-page"><div class="inner"><span>upload-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-version-page"><div class="inner"><span>version-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-wiki-page"><div class="inner"><span>wiki-page</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-wiki-routes"><div class="inner"><span>wiki-routes</span></div></a></li><li class="depth-1"><a href="smeagollib.routes.wiki.html#var-wrap-restricted-redirect"><div class="inner"><span>wrap-restricted-redirect</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">smeagollib.routes.wiki</h1><div class="doc"><div class="markdown"><p>Render all the main pages of a very simple Wiki engine.</p></div></div><div class="public anchor" id="var-auth-page"><h3>auth-page</h3><div class="usage"><code>(auth-page request)</code></div><div class="doc"><div class="markdown"><p>Render the authentication (login) page</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L375">view source</a></div></div><div class="public anchor" id="var-collect-preferred"><h3>collect-preferred</h3><div class="usage"><code>(collect-preferred processed-text)</code><code>(collect-preferred processed-text resource-type)</code></div><div class="doc"><div class="markdown"><p>Collect preferred variants of resources required by extensions used in the page described in this <code>processed-text</code>.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L162">view source</a></div></div><div class="public anchor" id="var-diff-page"><h3>diff-page</h3><div class="usage"><code>(diff-page request)</code></div><div class="doc"><div class="markdown"><p>Render a diff between two versions of a page</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L351">view source</a></div></div><div class="public anchor" id="var-edit-css-page"><h3>edit-css-page</h3><div class="usage"><code>(edit-css-page request)</code></div><div class="doc"><div class="markdown"><p>Render a stylesheet in a text-area for editing..</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L120">view source</a></div></div><div class="public anchor" id="var-edit-page"><h3>edit-page</h3><div class="usage"><code>(edit-page request)</code><code>(edit-page request default suffix template side-bar)</code></div><div class="doc"><div class="markdown"><p>Render a page in a text-area for editing. This could have been done in the same function as wiki-page, and that would have been neat, but I couldn’t see how to establish security if that were done.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L86">view source</a></div></div><div class="public anchor" id="var-format-instant"><h3>format-instant</h3><div class="usage"><code>(format-instant unix-time)</code><code>(format-instant unix-time template)</code></div><div class="doc"><div class="markdown"><p>Format this <code>unix-time</code>, expected to be a Long, into something human readable. If <code>template</code> is supplied, use that as the formatting template as specified for java.time.Formatter. Assumes system default timezone. Returns a string.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L251">view source</a></div></div><div class="public anchor" id="var-history-page"><h3>history-page</h3><div class="usage"><code>(history-page request)</code></div><div class="doc"><div class="markdown"><p>Render the history for the markdown page specified in this <code>request</code>, if any. If none, error?</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L228">view source</a></div></div><div class="public anchor" id="var-image-extns"><h3>image-extns</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>File name extensions suggesting files which can be considered to be images.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L247">view source</a></div></div><div class="public anchor" id="var-list-uploads-page"><h3>list-uploads-page</h3><div class="usage"><code>(list-uploads-page request)</code></div><div class="doc"><div class="markdown"><p>Render a list of all uploaded files</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L264">view source</a></div></div><div class="public anchor" id="var-md-include-system"><h3>md-include-system</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Allowing Markdown includes. Unfortunately the contributor who contributed this didn’t document it, and I haven’t yet worked out how it works. TODO: investigate and document.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L126">view source</a></div></div><div class="public anchor" id="var-passwd-page"><h3>passwd-page</h3><div class="usage"><code>(passwd-page request)</code></div><div class="doc"><div class="markdown"><p>Render a page to change the user password</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L432">view source</a></div></div><div class="public anchor" id="var-preferred-source"><h3>preferred-source</h3><div class="usage"><code>(preferred-source component ks)</code></div><div class="doc"><div class="markdown"><p>Here, <code>component</code> is expected to be a map with two keys, <code>:local</code> and <code>:remote</code>. If the value of <code>:extensions-from</code> in <code>config.edn</code> is remote AND the value of <code>:remote</code> is not nil, then the value of <code>:remote</code> will be returned. Otherwise, if the value of <code>:local</code> is nil and the value of <code>:remote</code> is non-nil, the value of <code>:remote</code> will be returned. By default, the value of <code>:local</code> will be returned.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L138">view source</a></div></div><div class="public anchor" id="var-process-source"><h3>process-source</h3><div class="usage"><code>(process-source params suffix request)</code></div><div class="doc"><div class="markdown"><p>Process <code>source-text</code> and save it to the specified <code>file-path</code>, committing it to Git and finally redirecting to wiki-page.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L60">view source</a></div></div><div class="public anchor" id="var-upload-page"><h3>upload-page</h3><div class="usage"><code>(upload-page request)</code></div><div class="doc"><div class="markdown"><p>Render a form to allow the upload of a file.</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L312">view source</a></div></div><div class="public anchor" id="var-version-page"><h3>version-page</h3><div class="usage"><code>(version-page request)</code></div><div class="doc"><div class="markdown"><p>Render a specific historical version of a page</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L335">view source</a></div></div><div class="public anchor" id="var-wiki-page"><h3>wiki-page</h3><div class="usage"><code>(wiki-page request)</code></div><div class="doc"><div class="markdown"><p>Render the markdown page specified in this <code>request</code>, if any. If none found, redirect to edit-page</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L197">view source</a></div></div><div class="public anchor" id="var-wiki-routes"><h3>wiki-routes</h3><div class="usage"></div><div class="doc"><div class="markdown"><p><strong>TODO</strong>: write docs</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L455">view source</a></div></div><div class="public anchor" id="var-wrap-restricted-redirect"><h3>wrap-restricted-redirect</h3><div class="usage"><code>(wrap-restricted-redirect f request)</code></div><div class="doc"><div class="markdown"><p><strong>TODO</strong>: write docs</p></div></div><div class="src-link"><a href="https://github.com/journeyman-cc/smeagollib/blob/master/src/smeagollib/routes/wiki.clj#L409">view source</a></div></div></div></body></html>